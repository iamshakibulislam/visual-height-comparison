<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Height Comparison</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'Font Awesome 5 Free';
            font-style: normal;
            font-weight: 900;
            src: url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/webfonts/fa-solid-900.woff2") format("woff2");
        }

        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
        }

        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .navbar {
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-weight: 600;
            color: var(--primary-color) !important;
        }

        .container-fluid {
            padding: 2rem;
        }

        .sidebar {
            background: white;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
            padding: 1.5rem;
        }

        .main-content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
            padding: 1.5rem;
        }

        .gender-btn {
            border: 2px solid #e9ecef;
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .gender-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .color-option {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: transform 0.2s;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.active {
            border-color: #333;
        }

        .canvas-container {
            width: 100%;
            height: 70vh;
            position: relative;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: #fcfcfc;
            display: flex;
            overflow: hidden;
            padding: 0;
            margin: 0;
        }

        .height-scale {
            position: relative;
            width: 60px;
            border-right: 1px solid #e9ecef;
            background: white;
            flex-shrink: 0;
        }

        .right-scale {
            border-right: none;
            border-left: 1px solid #e9ecef;
        }

        .scale-mark {
            position: absolute;
            width: 100%;
            border-top: 1px solid #e9ecef;
            padding: 2px 5px;
            font-size: 12px;
            color: #6c757d;
        }

        .left-scale .scale-mark {
            text-align: left;
        }

        .right-scale .scale-mark {
            text-align: right;
        }

        canvas {
            flex-grow: 1;
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }

        .form-control {
            border: 2px solid #e9ecef;
            padding: 0.7rem;
            border-radius: 8px;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: none;
        }

        .btn-primary {
            background: var(--primary-color);
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 8px;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
        }

        .edit-panel {
            display: none;
            background: white;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .person-label {
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            color: white;
            cursor: pointer;
        }

        .person-label .collapse {
            background: white;
            margin: 10px -10px -10px -10px;
            padding: 15px;
            border-radius: 0 0 8px 8px;
            color: #333;
        }

        .person-label .form-control {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
        }

        .person-label .color-option {
            width: 25px;
            height: 25px;
        }

        .height-label {
            position: relative;
            cursor: pointer;
        }

        .height-controls {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            border-radius: 4px;
            padding: 4px 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
            white-space: nowrap;
        }

        .height-controls i {
            margin: 0 4px;
            cursor: pointer;
            color: #6c757d;
        }

        .height-controls i:hover {
            color: #333;
        }

        .height-label:hover .height-controls {
            display: block;
        }

        .person-label {
            margin-bottom: 10px;
            border-radius: 8px;
            overflow: hidden;
        }

        .person-label .collapse {
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .person-label .fa-times {
            cursor: pointer;
            padding: 5px;
        }

        .person-label .fa-times:hover {
            opacity: 0.8;
        }

        .edit-panel .color-option {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .edit-panel .color-option.active {
            border-color: white;
        }

        .custom-color-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid #e9ecef;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .custom-color-btn:hover {
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .custom-color-btn i {
            color: #666;
            font-size: 14px;
        }

        .color-picker-container {
            position: relative;
        }

        .color-options {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }

        .custom-color-wrapper {
            position: relative;
            display: inline-block;
        }

        .custom-color-input {
            position: absolute;
            width: 35px;
            height: 35px;
            top: 0;
            left: 0;
            opacity: 0;
            cursor: pointer;
        }

        .custom-color-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid #e9ecef;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .custom-color-btn:hover {
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .custom-color-btn i {
            color: #666;
            font-size: 14px;
            pointer-events: none;
        }

        .edit-panel .custom-color-wrapper {
            position: relative;
            display: inline-block;
        }

        .edit-panel .custom-color-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 2px solid #e9ecef;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .edit-panel .custom-color-btn:hover {
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .edit-panel .custom-color-input {
            position: absolute;
            width: 25px;
            height: 25px;
            top: 0;
            left: 0;
            opacity: 0;
            cursor: pointer;
        }

        .edit-panel .custom-color-btn i {
            color: #666;
            font-size: 12px;
            pointer-events: none;
        }

        .side-nav {
            background: white;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
            overflow: hidden;
        }

        .nav-item {
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #666;
        }

        .nav-item:hover {
            background: #f8f9fa;
        }

        .nav-item.active {
            background: #f8f9fa;
            color: var(--primary-color);
            font-weight: 500;
        }

        .nav-item i {
            width: 20px;
            text-align: center;
        }

        .content-section {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-ruler-vertical me-2"></i>
                Height Comparison
            </a>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row g-4">
            <div class="col-md-3">
                <div class="side-nav mb-3">
                    <div class="nav-item active" data-target="addPerson">
                        <i class="fas fa-user-plus"></i>
                        <span>Add Person</span>
                    </div>
                    <div class="nav-item" data-target="celebrities">
                        <i class="fas fa-star"></i>
                        <span>Celebrities</span>
                    </div>
                </div>

                <div id="addPersonContent" class="content-section">
                    <div class="sidebar">
                        <h5 class="mb-4">Add New Person</h5>
                        <div class="mb-4">
                            <div class="d-flex gap-2 mb-3">
                                <button class="gender-btn flex-grow-1 active" data-gender="male">
                                    <i class="fas fa-male me-2"></i>Male
                                </button>
                                <button class="gender-btn flex-grow-1" data-gender="female">
                                    <i class="fas fa-female me-2"></i>Female
                                </button>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Name (Optional)</label>
                                <input type="text" id="name" class="form-control" placeholder="Enter name">
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Height</label>
                                <div class="d-flex gap-2">
                                    <input type="number" id="feet" class="form-control" placeholder="ft">
                                    <input type="number" id="inches" class="form-control" placeholder="in">
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="form-label">Choose Color</label>
                            <div class="d-flex gap-2 flex-wrap align-items-center color-picker-container">
                                <div class="color-options">
                                    <div class="color-option active" style="background: #4361ee"></div>
                                    <div class="color-option" style="background: #3a0ca3"></div>
                                    <div class="color-option" style="background: #f72585"></div>
                                    <div class="color-option" style="background: #4cc9f0"></div>
                                    <div class="color-option" style="background: #7209b7"></div>
                                </div>
                                <div class="custom-color-wrapper">
                                    <button class="custom-color-btn" id="customColorBtn">
                                        <i class="fas fa-pencil-alt"></i>
                                    </button>
                                    <input type="color" id="colorPicker" class="custom-color-input">
                                </div>
                            </div>
                        </div>

                        <button class="btn btn-primary w-100" id="addPerson">
                            <i class="fas fa-plus me-2"></i>Add Person
                        </button>
                    </div>
                </div>

                <div id="celebritiesContent" class="content-section d-none">
                    <div class="sidebar">
                        <h5 class="mb-4">Celebrities</h5>
                        <!-- Add celebrities content here -->
                    </div>
                </div>
            </div>

            <div class="col-md-9">
                <div class="main-content">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-secondary" id="clearAll">
                                <i class="fas fa-trash-alt me-2"></i>Clear All
                            </button>
                            <button class="btn btn-outline-primary" id="editMode">
                                <i class="fas fa-edit me-2"></i>Edit
                            </button>
                        </div>
                        <button class="btn btn-primary" id="shareBtn">
                            <i class="fas fa-share-alt me-2"></i>Share
                        </button>
                    </div>

                    <div class="canvas-container">
                        <canvas id="heightCanvas"></canvas>
                        <div class="height-scale right-scale" id="heightScaleFt"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Initialize canvas and variables
        const canvas = document.getElementById('heightCanvas');
        const ctx = canvas.getContext('2d');
        let selectedColor = null;
        let selectedGender = 'male';
        const people = [];

        // Draw height measurement lines and labels
        function drawHeightScales() {
            const maxHeight = 255;
            const heightPx = canvas.height;
            const heights = [255, 242, 229, 216, 204, 191, 178, 165, 153, 140, 127, 115, 102, 89, 76, 64, 51, 38, 25, 13];

            // Clear canvas first
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw grid lines for each specific height
            heights.forEach(h => {
                const position = heightPx - (h * heightPx / maxHeight);
                
                // Draw line across entire canvas width
                ctx.beginPath();
                ctx.strokeStyle = '#e9ecef';
                ctx.moveTo(0, position);
                ctx.lineTo(canvas.width, position);
                ctx.stroke();

                // Add cm label directly on canvas
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`${h}`, 5, position - 5);
            });
        }

        // Store click areas for delete buttons
        let deleteButtonAreas = [];

        // Function to check if click is within a delete button
        function isClickOnDeleteButton(x, y) {
            return deleteButtonAreas.findIndex(area => 
                x >= area.x && x <= area.x + area.width &&
                y >= area.y && y <= area.y + area.height
            );
        }

        // Add canvas click handler for delete buttons
        canvas.addEventListener('click', (event) => {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            const deleteIndex = isClickOnDeleteButton(x, y);
            if (deleteIndex !== -1) {
                // Remove the person at this index
                people.splice(deleteIndex, 1);
                // Redraw the canvas
                drawPeople();
            }
        });

        // Update drawPeople function to include delete buttons
        async function drawPeople() {
            // Clear delete button areas
            deleteButtonAreas = [];
            
            // Draw grid lines first
            drawHeightScales();
            
            const personWidth = 60;
            const spacing = 40;
            const totalWidth = people.length * (personWidth + spacing) - spacing;
            window.startX = (canvas.width - totalWidth) / 2;
            window.labelAreas = [];
            
            // Draw each person
            for (const [index, person] of people.entries()) {
                const x = window.startX + (index * (personWidth + spacing));
                const pixelHeight = (person.height * canvas.height) / 255;
                const y = canvas.height - pixelHeight;
                
                let svgData;
                
                // Choose SVG based on height and gender
                if (person.height <= 86.36) {
                    svgData = `<?xml version="1.0" encoding="UTF-8"?>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 332.33 881.41">
                            <path fill="${person.color}" d="M228.96,871.62c.92,5.53-3.94,8.74-8.79,8.99-16.4,.84-10.72-15.67-15.92-25.8-4.92-9.58-14.15-14.66-12.56-27.09,.02-.16,.77-3.28,2.24-9.36,1.63-6.74,3.58-13.04,3.35-20.09-.17-5.21-1.66-15.87-4.48-32-2.03-11.59-4.05-23.18-6.05-34.77-1.97-11.36-1.14-22.09-.18-33.47,.04-.45-.19-1.09-.69-1.92-11.41-18.81-19.11-40.02-18.07-62.32,.75-16.16,3.29-31.8,5.52-47.77,.04-.27,.02-.43-.06-.48-.13-.07-.39,.17-.44,.21-.47,.42-4.69,2.25-10.16,3.11-7.37,1.16-12.35-.19-12.97-.79-.05-.05-.37-.38-.55-.29-.11,.05-.16,.26-.13,.62,1.66,18.45,5.74,36.45,4.13,55.7-1.31,15.57-5.86,29.26-13.52,42.59-2.05,3.57-4.18,7.1-6.37,10.58-.23,.37-.3,1.21-.22,2.5,.49,7.75,.66,15.5,.5,23.26-.1,4.72-1.33,12.86-3.7,24.43-3.55,17.35-8.81,35.29-10.56,52.57-1.57,15.54,11.19,27.84,.86,43.41-3.27,4.93-6.15,9.04-8.64,12.33-5.67,7.49-.84,24.84-15.46,25.62-4.66,.24-10.04-2.25-10.88-7.4-.08-.49-.25-.53-.52-.1-2.84,4.5-10.03,10.1-14.48,4.72-.28-.34-.77-.4-1.12-.15-3.77,2.64-7,2.23-9.7-1.23-.2-.25-.45-.32-.74-.21-3.25,1.22-5.8,.52-7.66-2.09-.75-1.05-.56-2.09-.93-3.35-.1-.33-.31-.56-.64-.67-5.61-1.89-5.49-9.68-2.19-13.18,2.17-2.3,4.29-4.33,5.78-7.16,4.73-9.03,8.31-17.43,14.49-25.7,2.98-3.99,4.76-6.71,5.35-8.18,2.53-6.32,1.53-13.5-.45-19.88-2.45-7.87-4.7-15.8-6.77-23.78-5.88-22.67-6.59-46.31-3.92-69.49,.83-7.21,2.35-17.54,4.57-31.01,.87-5.25,1.41-10.91,1.62-16.99,.54-15.57,.28-31.63-3.65-46.27-3.25-12.07-6.36-22.52-7.63-33.82-2.17-19.18-.04-39.05,.92-56.93,.61-11.52,.31-23-.92-34.44-.62-5.82-.81-10.23-.58-13.24,.93-11.66,5.05-23.02,8.75-34.04,.38-1.11,.57-3.23,.44-4.7-.73-8.05-1.85-16.54-1.53-24.41,.04-.93,.71-10.52,.69-10.53-.15-.15-.25-.13-.3,.08-3.87,16.33-8.75,32.37-14.63,48.1-5.28,14.1-9.08,24.39-12.29,37.56-.08,.32-.02,.61,.18,.88,5.88,8.08,9.37,17.32,11.51,27.21,.71,3.27,1.38,5.75,2.01,7.43,1.15,3.01,3.66,7.74,3.64,11.29-.01,3.46-2.49,6.71-6.21,5.81-5.52-1.34-9.59-10.88-12.08-15.77-.54-1.08-1.8-1.58-2.95-1.18-3.26,1.13-4.68,5.36-5.89,8.25-2.62,6.3-2.34,11.76,.63,18.03,1.32,2.8,2.38,3.6,5.55,4.31,5.04,1.13,11.29,2.22,11.56,8.35,.14,3.16-4.6,3.84-6.87,3.87-.67,0-1.22,.5-1.31,1.16-1.27,9.53-14.64,2.65-18.61-.32-5.62-4.21-11.27-9.44-13.78-16.18-1.46-3.93-1.58-10.14-3.17-15.09-2.42-7.51-1.04-15.59,.16-24.51,.82-6.14,1.05-11.49,.21-17.98-.54-4.2-.83-7.09-.87-8.68-.43-18.49,.21-37.57,1.92-57.25,1.4-16.1,4.49-29.28,10.13-45.44,2.91-8.34,5.73-16.71,8.44-25.12,.13-.41-.01-.61-.44-.58l-7.99,.43c-.24,.01-.45-.18-.46-.42,0-.07,.01-.14,.04-.2,5.18-11.09,11.15-20.38,13.85-33.03,3.89-18.2,6.1-30.54,12.32-45.34,5.14-12.25,13.93-25.45,25.89-31.97,1.85-1.01,6.11-2.63,12.77-4.86,16.02-5.36,31.13-11.97,44.48-22.44,.23-.17,.28-.5,.1-.73-.03-.04-.07-.08-.11-.11-7.16-5.17-12.89-11.68-17.19-19.53-3.53-6.45-4.57-16.22-5.14-23.66-.02-.2-.2-.34-.4-.32-.08,0-.16,.04-.21,.1-6.9,7.07-11.34,2.36-14.8-4.33-2.88-5.56-18.5-37.74-8.95-40.93,2.72-.91,5.54-.04,8.47,2.59,.54,.49,.76,.37,.66-.36-.47-3.4-1.37-7.1-1.74-10.39-1.53-13.43-2.79-26.88-3.8-40.35-.23-3.17-1.49-4.95-.36-8.51,2.01-6.32,2.81-13.12,9.34-18.15,.26-.21,.41-.53,.4-.86-.25-6.63,5.01-9.9,8-14.83,1.96-3.22,3.19-4.62,6.59-6.28,.31-.15,.54-.37,.7-.68,2.41-4.59,6.67-9.84,11.51-12.04,2.88-1.3,5.6-3.16,8.72-3.53,1.97-.24,3.63-.06,5.46-1.03,2.75-1.46,5.61-2.68,8.56-3.66,2.24-.75,4.02-2.58,6.44-3.08,3.27-.67,6.86-.95,10.77-.82,.34,.01,.66-.07,.95-.24,2.59-1.47,5.34-2.06,8.26-1.75,5.3,.56,8.41-1.13,13.73,2.37,.27,.18,.58,.28,.9,.29,4.33,.11,11.52-.19,13.33,1.21,3.06,2.36,6.56,2.32,10.17,3.1,3.34,.73,6.4,2.9,9.58,4.37,3.39,1.57,5.96,4.04,9.27,5.88,2.01,1.11,2.53,2.78,4.17,4.01,2.47,1.85,4.47,4.1,5.98,6.76,2.31,4.08,5.73,6.83,7.93,11.07,2.33,4.5,2.63,10.16,5.78,15.15,.6,.95,1.32,2.37,2.15,4.25,1.46,3.32,3.96,4.46,3.94,8.71-.11,20.84-2.82,41.33-8.11,61.48-.14,.53,0,.62,.42,.27,3.03-2.55,7.19-6.76,11.62-4.89,8.28,3.48-5.74,32.23-8.86,38.91-2.26,4.84-4.67,10.72-11.08,8.74-1.28-.39-1.92-1.35-2.76-2.32-.16-.18-.44-.2-.62-.05-.08,.07-.13,.16-.14,.26-2.78,16.75-8.05,30.09-21.16,41.28-.11,.09-.13,.26-.03,.37h0c5.96,6.7,12.8,12.2,20.53,16.5,13.96,7.79,28.84,8.49,41.59,19.66,14.2,12.43,22.06,30.63,24.36,49.07,1.52,12.15,5.28,22.46,11.93,32.82,5.07,7.89,8.39,13.94,10.94,21.95,.09,.28-.07,.58-.34,.67-.06,.02-.12,.03-.19,.02l-9.26-.43c-.38-.02-.5,.15-.35,.5,9.82,23.03,18.65,46.46,20.27,71.71,1.14,17.65,1.72,34.15,1.75,49.51,0,4.71-.52,9.6-1.57,14.66-.79,3.79-.92,8.54-.38,11.59,1.24,6.96,2.15,13.96,2.72,21,.3,3.62-.06,6.01-1.19,9.9-.93,3.21-1.85,7.58-2.74,13.11-1.57,9.77-13.47,18.72-22.05,22.53-4.5,2-9.45,1.56-9.98-4.41-.03-.3-.29-.53-.59-.5h-.03c-3.81,.42-9.27,.09-8.2-5.1,1.14-5.5,5.93-5.87,11.09-7.16,2.57-.64,3.6-2.62,4.88-5.12,2.42-4.72,2.78-9.7,1.08-14.95-.9-2.76-5.6-14.77-9.32-8.58-2.04,3.4-4.21,6.72-6.51,9.95-2.12,2.99-7.64,6.46-11,3.83-5.22-4.08,.85-13.37,2.7-17.62,2.7-6.18,3.32-13.11,6.08-19.32,1.73-3.9,3.88-7.52,6.44-10.87,.48-.62,.7-1.41,.64-2.2-1.07-12.98-5.47-23.88-11.12-37.95-5.35-13.34-10.09-29.8-14.22-49.39-.02-.07-.06-.11-.12-.11h-.05s-.06,.02-.05,.06c.94,13.02-1.84,24.14-4.67,38.26-.26,1.31,.14,4.16,.59,5.82,3.06,11.28,4.91,18.56,5.55,21.83,2.49,12.67-.01,23.13-3.16,36.24-.51,2.15-.13,5.32,.36,7.96,5.89,31.73,1.91,64.33-6.88,95.29-.68,2.4-2.18,8.15-4.49,17.25-2.06,8.1-2.91,15.45-3.06,24.42-.28,16.96,.42,28.31,3.64,45.08,4.63,24.2,5.3,50.69-1.21,74.07-4.32,15.51-10.06,31.39-12.07,47.42-.59,4.66,.51,8.63,3.28,11.9,4.73,5.57,8.65,11.65,11.76,18.24,1.99,4.21,3.92,9.89,6.94,13.39,3.4,3.93,6.75,5.52,5.85,11.73-.37,2.59-1.75,4.35-4.13,5.3-.29,.12-.5,.38-.56,.7-.84,4.74-3.7,6.64-8.57,5.69-.38-.07-.7,.04-.95,.33-3.01,3.46-6.47,3.91-10.38,1.36-.28-.19-.56-.19-.84,0-8.26,5.48-11.93-1.57-15.69-7.41-.3-.47-.4-.43-.31,.12Z"/>
                        </svg>`;
                }

                if (svgData) {
                    const blob = new Blob([svgData], { type: 'image/svg+xml' });
                    const url = URL.createObjectURL(blob);
                    
                    const img = new Image();
                    img.src = url;
                    
                    await new Promise((resolve) => {
                        img.onload = () => {
                            const aspectRatio = img.height / img.width;
                            const drawWidth = personWidth;
                            const drawHeight = pixelHeight;
                            
                            ctx.drawImage(img, x, y, drawWidth, drawHeight);
                            URL.revokeObjectURL(url);
                            resolve();
                        };
                    });
                }
                
                const labelX = x + personWidth/2;
                const labelY = y - 60;
                
                // Draw delete button
                const deleteButtonSize = 24;
                const deleteButtonX = labelX - deleteButtonSize/2;
                const deleteButtonY = labelY - 35;
                
                // Store delete button area for click detection
                deleteButtonAreas.push({
                    x: deleteButtonX,
                    y: deleteButtonY,
                    width: deleteButtonSize,
                    height: deleteButtonSize,
                    index: index
                });

                // Draw delete button background circle
                ctx.beginPath();
                ctx.fillStyle = '#ff4444';
                ctx.arc(deleteButtonX + deleteButtonSize/2, deleteButtonY + deleteButtonSize/2, deleteButtonSize/2, 0, Math.PI * 2);
                ctx.fill();

                // Draw trash icon
                ctx.fillStyle = 'white';
                ctx.font = '14px "Font Awesome 5 Free"';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('\uf2ed', deleteButtonX + deleteButtonSize/2, deleteButtonY + deleteButtonSize/2);
                
                // Draw label
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.roundRect(labelX - 50, labelY - 10, 100, 60, 5);
                ctx.fill();
                
                ctx.fillStyle = '#333';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                
                const feet = Math.floor(person.height/30.48);
                const inches = Math.round((person.height/2.54)%12);
                const heightText = `${person.name}\n${Math.round(person.height)}cm\n${feet}'${inches}"`;
                const lines = heightText.split('\n');
                lines.forEach((line, i) => {
                    ctx.fillText(line, labelX, labelY + (i * 20));
                });
                
                // Store label area
                window.labelAreas.push({
                    x: labelX - 50,
                    y: labelY - 35,
                    width: 100,
                    height: 85,
                    person: index,
                    isHovered: false
                });
            }
        }

        // Initialize canvas size
        function resizeCanvas() {
            const container = document.querySelector('.canvas-container');
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
            drawHeightScales();
            drawPeople();
        }

        // Event listeners
        window.addEventListener('resize', resizeCanvas);
        window.addEventListener('load', resizeCanvas);

        // Initialize immediately
        resizeCanvas();

        // Add these event listeners and functions
        document.getElementById('addPerson').addEventListener('click', async () => {
            const name = document.getElementById('name').value;
            const feet = parseInt(document.getElementById('feet').value) || 0;
            const inches = parseInt(document.getElementById('inches').value) || 0;
            
            const heightInCm = (feet * 30.48) + (inches * 2.54);
            
            if (heightInCm > 0) {
                // Get color from either color picker or default options or random
                let personColor;
                const activeColorOption = document.querySelector('.color-option.active');
                
                if (selectedColor) {
                    personColor = selectedColor;  // Use color picker value if available
                } else if (activeColorOption) {
                    personColor = activeColorOption.style.backgroundColor;  // Use selected color option
                } else {
                    personColor = getRandomColor();  // Use random color if no color is selected
                }

                const person = {
                    name: name || 'Person ' + (people.length + 1),
                    height: heightInCm,
                    color: personColor,
                    gender: selectedGender
                };

                people.push(person);
                
                // Clear inputs
                document.getElementById('name').value = '';
                document.getElementById('feet').value = '';
                document.getElementById('inches').value = '';
                
                // Reset gender selection
                document.querySelectorAll('.gender-btn').forEach((btn, index) => {
                    if (index === 0) {
                        btn.classList.add('active');
                        selectedGender = 'male';
                    } else {
                        btn.classList.remove('active');
                    }
                });

                await drawPeople();
            }
        });

        // Add color selection functionality
        document.querySelectorAll('.color-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.color-option').forEach(opt => {
                    opt.classList.remove('active');
                });
                option.classList.add('active');
                selectedColor = option.style.backgroundColor;
            });
        });

        // Add color picker functionality
        const customColorBtn = document.getElementById('customColorBtn');
        const colorPicker = document.getElementById('colorPicker');

        customColorBtn.addEventListener('click', () => {
            colorPicker.click();
        });

        colorPicker.addEventListener('input', (e) => {
            const newColor = e.target.value;
            selectedColor = newColor;
            
            // Remove active class from all color options
            document.querySelectorAll('.color-option').forEach(opt => {
                opt.classList.remove('active');
            });
        });

        // Add gender selection functionality
        document.querySelectorAll('.gender-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.gender-btn').forEach(b => {
                    b.classList.remove('active');
                });
                btn.classList.add('active');
                selectedGender = btn.getAttribute('data-gender');
            });
        });

        // Add Clear All functionality
        document.getElementById('clearAll').addEventListener('click', () => {
            // Clear the people array
            people.length = 0;
            
            // Redraw the canvas with just the height scales
            drawHeightScales();
        });

        // Helper function for random color
        function getRandomColor() {
            const colors = [
                '#4361ee', '#3a0ca3', '#f72585', '#4cc9f0', '#7209b7',
                '#480ca8', '#3f37c9', '#4895ef', '#560bad', '#b5179e'
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }
    </script>
</body>
</html>
